(Business Logic)

1. مدیریت مشتریان (Customer Management)

وظایف:

ثبت مشتری جدید:

اطلاعات موردنیاز: نام، آدرس، شماره تلفن، ایمیل.

شناسه مشتری به صورت خودکار تولید می‌شود.


به‌روزرسانی اطلاعات مشتری:

امکان تغییر نام، آدرس، شماره تلفن، و ایمیل مشتری.


حذف مشتری:

مشتریانی که به آن‌ها فاکتور اختصاص داده نشده است، قابل حذف هستند.



قیود:

هر مشتری باید یک ایمیل منحصربه‌فرد داشته باشد.

شماره تلفن مشتری باید معتبر باشد (طول، فرمت).



---

2. مدیریت کالاها (Product Management)

وظایف:

ثبت کالا:

اطلاعات موردنیاز: نام کالا، توضیحات، قیمت واحد، موجودی.

شناسه کالا به صورت خودکار تولید می‌شود.


به‌روزرسانی اطلاعات کالا:

امکان تغییر نام، توضیحات، قیمت واحد، و موجودی کالا.


حذف کالا:

فقط کالاهایی که در هیچ فاکتوری استفاده نشده‌اند، قابل حذف هستند.



قیود:

قیمت کالا نمی‌تواند منفی باشد.

موجودی کالا نمی‌تواند کمتر از صفر باشد.



---

3. مدیریت فاکتورها (Invoice Management)

وظایف:

ایجاد فاکتور:

اطلاعات موردنیاز: شناسه مشتری، تاریخ، و وضعیت اولیه (پیش‌فرض: "PENDING").

مجموع مبلغ فاکتور به صورت خودکار از اقلام محاسبه می‌شود.


به‌روزرسانی فاکتور:

امکان تغییر وضعیت فاکتور ("PENDING"، "PAID"، "CANCELLED").

فقط فاکتورهایی که وضعیت آن‌ها "PENDING" است، قابل به‌روزرسانی هستند.


حذف فاکتور:

فقط فاکتورهایی که وضعیت "PENDING" دارند، قابل حذف هستند.

با حذف فاکتور، تمام اقلام مرتبط با آن نیز حذف می‌شوند.



قیود:

هر فاکتور باید به یک مشتری معتبر اختصاص داده شود.

فاکتورهای "PAID" و "CANCELLED" غیرقابل حذف یا ویرایش هستند.



---

4. مدیریت اقلام فاکتور (Invoice Items Management)

وظایف:

اضافه کردن کالا به فاکتور:

اطلاعات موردنیاز: شناسه فاکتور، شناسه کالا، تعداد، قیمت واحد.

موجودی کالا بررسی می‌شود؛ در صورت کافی نبودن موجودی، عملیات انجام نمی‌شود.


به‌روزرسانی اقلام فاکتور:

امکان تغییر تعداد و قیمت واحد اقلام.

موجودی کالا بر اساس تغییر تعداد، به‌روزرسانی می‌شود.


حذف اقلام از فاکتور:

امکان حذف یک قلم خاص از فاکتور.

موجودی کالا به حالت قبل بازگردانده می‌شود.



قیود:

فقط برای فاکتورهایی با وضعیت "PENDING"، عملیات روی اقلام مجاز است.

تعداد کالای انتخابی نمی‌تواند بیشتر از موجودی فعلی باشد.



---

5. گزارش‌گیری (Reporting)

وظایف:

گزارش مشتریان:

نمایش تمام مشتریان ثبت‌شده.

امکان فیلتر بر اساس نام یا شماره تلفن.


گزارش کالاها:

نمایش تمام کالاها و موجودی آن‌ها.

امکان فیلتر بر اساس نام کالا یا موجودی.


گزارش فاکتورها:

نمایش فاکتورهای ثبت‌شده.

امکان فیلتر بر اساس مشتری، تاریخ، یا وضعیت.


گزارش جزئیات فاکتور:

نمایش تمام اقلام مرتبط با یک فاکتور خاص.




---

جریان‌های اصلی (Main Flows)

جریان ثبت مشتری

1. دریافت اطلاعات مشتری.


2. بررسی صحت اطلاعات (ایمیل معتبر، شماره تلفن صحیح).


3. ذخیره اطلاعات مشتری در پایگاه داده.



جریان ثبت کالا

1. دریافت اطلاعات کالا.


2. بررسی صحت اطلاعات (قیمت مثبت، موجودی مناسب).


3. ذخیره اطلاعات کالا در پایگاه داده.



جریان ایجاد فاکتور

1. دریافت شناسه مشتری و تاریخ.


2. ایجاد فاکتور با وضعیت "PENDING".


3. بازگرداندن شناسه فاکتور برای اضافه کردن اقلام.



جریان اضافه کردن اقلام به فاکتور

1. دریافت شناسه فاکتور، شناسه کالا، تعداد، و قیمت واحد.


2. بررسی موجودی کالا.


3. ذخیره اطلاعات در جدول اقلام فاکتور.


4. کاهش موجودی کالا.



جریان گزارش‌گیری

1. دریافت نوع گزارش (مشتری، کالا، فاکتور).


2. اجرای کوئری مربوطه.


3. نمایش داده‌های فیلترشده.




---

اعتبارسنجی‌ها (Validations)

مشتریان:

ایمیل و شماره تلفن معتبر.

جلوگیری از تکراری بودن ایمیل.


کالاها:

قیمت و موجودی مثبت.


فاکتورها:

وجود مشتری مرتبط.

وضعیت معتبر ("PENDING"، "PAID"، "CANCELLED").


اقلام فاکتور:

موجودی کافی برای تعداد درخواست‌شده.

عدم تغییر اقلام در فاکتورهای غیر "PENDING".




---

قوانین حذف (Delete Rules)

1. حذف مشتری:

مشتریانی که فاکتور دارند، قابل حذف نیستند.



2. حذف کالا:

کالاهایی که در فاکتور استفاده شده‌اند، قابل حذف نیستند.



3. حذف فاکتور:

فقط فاکتورهایی با وضعیت "PENDING" حذف می‌شوند.



4. حذف اقلام:

فقط اقلام مربوط به فاکتورهای "PENDING" حذف می‌شوند.





---

نکات اضافی

استفاده از تراکنش‌ها (Transactions) برای عملیات حساس مانند کاهش موجودی کالا.

استفاده از پیام‌های خطای مناسب برای کاربر.

پیاده‌سازی مکانیزم لاگ برای ثبت خطاها و عملیات مهم.



---
